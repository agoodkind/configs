# Debian network interfaces for attauth VM
# Handles AT&T 802.1X authentication using X710 SR-IOV VF with trust mode

auto lo
iface lo inet loopback

# Management interface - configured by cloud-init, don't override
# Cloud-init sets static IP based on VMID

# X710 VF - AT&T WAN (SR-IOV VF with trust mode)
auto {{ attauth_vf_iface }}
iface {{ attauth_vf_iface }} inet manual
pre-up ip link set {{ attauth_vf_iface }} up

# AT&T VLAN 3242 (created after wpa_supplicant authenticates)
# Note: VLAN is created by wpa_supplicant.service after auth
auto {{ attauth_vf_iface }}.{{ attauth_vlan_id }}
iface {{ attauth_vf_iface }}.{{ attauth_vlan_id }} inet manual
vlan-raw-device {{ attauth_vf_iface }}

# Bridge: AT&T VLAN â†’ Proxmox "att" bridge (virtio)
auto br-att
iface br-att inet manual
bridge_ports {{ attauth_att_bridge_iface }}
bridge_stp off
bridge_fd 0
post-up brctl addif br-att {{ attauth_vf_iface }}.{{ attauth_vlan_id }} 2>/dev/null || true