# Debian network interfaces configuration
# Generated by Ansible for mwan

# Loopback
auto lo
iface lo inet loopback

# Management interface (static IP based on VMID)
# IPv4: 10.250.0.<vmid_decimal>
    # IPv6: 3d06:bad:b01::<vmid_hex>
        auto {{ mwan_mgmt_iface }}
        iface {{ mwan_mgmt_iface }} inet static
        address {{ mwan_mgmt_ipv4 }}
        netmask 255.255.255.0
        gateway 10.250.0.1

        iface {{ mwan_mgmt_iface }} inet6 static
        address {{ mwan_mgmt_ipv6 }}
        netmask 64
        gateway 3d06:bad:b01::1

        # AT&T WAN - virtio on att bridge (authenticated by attauth VM)
        auto {{ mwan_att_iface }}
        iface {{ mwan_att_iface }} inet manual
        pre-up ip link set {{ mwan_att_iface }} up
        # DHCPv4 and DHCPv6-PD handled by dhcpcd

        # Webpass WAN - virtio on webpass bridge with MAC spoofing
        auto {{ mwan_webpass_iface }}
        iface {{ mwan_webpass_iface }} inet manual
        pre-up ip link set {{ mwan_webpass_iface }} address {{ mwan_webpass_mac }}
        pre-up ip link set {{ mwan_webpass_iface }} up
        # DHCPv4 and DHCPv6-PD handled by dhcpcd

        # Internal link (to OPNsense) - virtio on mwanbr
        auto {{ mwan_internal_iface }}
        iface {{ mwan_internal_iface }} inet static
        address {{ mwan_internal_ipv4 }}

        iface {{ mwan_internal_iface }} inet6 static
        address {{ mwan_internal_ipv6 }}

        {% if mwan_health_checks.monkeybrains.enabled | default(false) %}
        # Monkeybrains WAN - virtio on mbrains bridge (optional)
        auto {{ mwan_monkeybrains_iface }}
        iface {{ mwan_monkeybrains_iface }} inet manual
        pre-up ip link set {{ mwan_monkeybrains_iface }} up
        # DHCPv4 and DHCPv6-PD handled by dhcpcd
        {% endif %}