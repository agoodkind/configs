#!/bin/bash
# wpa_supplicant action script - writes auth status file
# wpa_cli -a passes "CONNECTED" or "DISCONNECTED" as $2

AUTH_FILE="/run/wpa_supplicant-mwan.authenticated"
WPA_CLI="/sbin/wpa_cli"

case "$2" in
    CONNECTED)
        echo "$(date '+%Y-%m-%d %H:%M:%S') CONNECTED" | \
            systemd-cat -t wpa-action
        touch "$AUTH_FILE"
        ;;
    DISCONNECTED)
        echo "$(date '+%Y-%m-%d %H:%M:%S') DISCONNECTED" | \
            systemd-cat -t wpa-action
        rm -f "$AUTH_FILE"
        ;;
esac

